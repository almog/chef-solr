<dataConfig>
  <dataSource driver="org.postgresql.Driver"
    url="jdbc:postgresql://mart1-prod-db1/bix_live"
    user="ko_backend"
    password="pf8qvx6z" />
  <document>
    <entity name="order" query="Select ord.id, rsrv.rno, NULL as invno, rsrv.currency, rsrv.create_date, rsrv.order_id1, rsrv.order_id2, rsrv.estore_id
      from orders ord
      INNER JOIN reservation rsrv
      ON (ord.ref_id = rsrv.rno) AND ord.ref_type = 'rsrv'
      Union all
      Select ord.id, inv.reservation_number, inv.invno, inv.currency, inv.create_date, inv.estore_order_number, inv.estore_order_number2, inv.estore_id
      from orders ord
      INNER JOIN invoice inv
      ON (ord.ref_id = inv.invno) AND ord.ref_type = 'invoice' AND inv.status Not in ('passive', 'unpaid advance')">
      <field column="id" name="id" />
      <field column="invno" name="invoice_number" />
      <field column="rno" name="reservation_number" />
      <field column="currency" name="currency" />
      <field column="create_date" name="create_date" />
      <field column="order_id1" name="order_ref1" />
      <field column="order_id2" name="order_ref2" />
    </entity>
  </document>
</dataConfig>
